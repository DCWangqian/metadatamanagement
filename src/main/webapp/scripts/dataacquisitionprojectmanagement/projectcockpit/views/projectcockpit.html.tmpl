
<div>
  <div layout="row" style="margin-bottom: 0px;" layout-margin>
    <h1 id="top" class="md-headline fdz-truncate-string" style="margin-left: 0px;">{{'projectcockpit.title' | translate}}</h1>
  </div>
  <div ng-if="!account || !project" layout="row" layout-sm="column" layout-align="space-around">
    <md-progress-circular md-mode="indeterminate"></md-progress-circular>
  </div>
  <div ng-if="account && project">
    <div layout="row" class="layout-margin layout-row md-body-2">{{'projectcockpit.search.header' | translate}} {{project.id}}:</div>
    <md-card>
      <md-autocomplete
        flex
        ng-disabled="false"
        md-search-text="searchText"
        md-search-text-change="searchTextChanged(searchText)"
        md-selected-item="selectedUser"
        md-selected-item-change="selectedUserChanged(selectedUser)"
        md-items="user in searchUsers(searchText)"
        md-item-text="user.login"
        md-min-length="1"
        md-delay="250"
        placeholder="{{'projectcockpit.search.placeholder' | translate}}"
        md-require-match="true"
        md-no-cache="true"
        style="margin-bottom: 8px"
        >
          <md-item-template>
            <div layout="row">
              <span md-highlight-text="searchText">{{user.login}} ({{user.firstName}} {{user.lastName}})</span>
              <span flex></span>
              <md-chips readonly="true" ng-if="!!user.authorities" ng-model="user.authorities">
                <md-chip-template class="authority">{{'projectcockpit.label.' + $chip | translate}}</md-chip-template>
              </md-chips>
            </div>
          </md-item-template>
          <md-not-found>
            <span data-translate="global.menu.entities.unknown-project"></span>
          </md-not-found>
      </md-autocomplete>

      <md-list ng-repeat="user in activeUsers">
        <md-list-item class="layout-row">
          <div class="md-list-item-text">
            <strong>{{user.login}}</strong>
            <p>{{user.firstName}} {{user.lastName}}</p>
          </div>
          <span flex></span>
          <md-chips readonly="true" ng-if="!!user.authorities" ng-model="user.authorities">
            <md-chip-template class="authority">{{'projectcockpit.label.' + $chip | translate}}</md-chip-template>
          </md-chips>
          <md-button ng-disabled="canDeleteUser(user)" class="md-primary md-raised" ng-click="removeUser(user)" aria-label="remove user">
            <md-icon md-font-set="material-icons" class="ng-binding ng-scope material-icons" role="img" aria-hidden="true">delete</md-icon>
          </md-button>
        </md-list-item>
      </md-list>
      <div class="layout-margin" ng-if="!activeUsers || !activeUsers.length">
        <i>{{'projectcockpit.list.empty' | translate}}</i>
      </div>
    </md-card>
  </div>

  <div class="fdz-fab-button-container" layout="column">
    <md-button class="md-raised md-fab md-primary" ng-click="saveChanges()" ng-disabled="!changed">
    <md-tooltip md-direction="left" md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
        {{'projectcockpit.button.save' | translate}}
    </md-tooltip>
    <md-icon md-font-set="material-icons">save</md-icon>
    </md-button>
  </div>
</div>
