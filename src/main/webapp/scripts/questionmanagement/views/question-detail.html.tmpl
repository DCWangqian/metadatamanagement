<div ng-if="ctrl.question.id">
    <div layout="row" style="margin-bottom: 0px;" layout-margin>
        <h1 class="md-headline" style="margin-left: 0px;">{{'question-management.detail.question' | translate}} {{ctrl.question.number}}: <span ng-if='ctrl.instrument' display-i18n-string="ctrl.instrument.description"></span> <span class="label label-as-badge label-default">{{ctrl.question.id}}</span></h1>
    </div>
    <div layout="column" layout-gt-sm="row">
        <div flex-gt-sm="50" layout="column">
            <md-card flex="auto">
                <md-card-header>
                    <md-card-header-text>
                        <h2 class="md-title">{{'global.cards.details' | translate }}</h2>
                    </md-card-header-text>
                </md-card-header>
                <md-divider></md-divider>
                <md-card-content>
                    <div class="fdz-add-bottom-margin" ng-if="ctrl.question.number">
                        <span style="font-weight: bold;">{{'question-management.detail.number' | translate }}:</span>
                        <span>{{ctrl.question.number}}</span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="ctrl.question.questionText">
                        <span style="font-weight: bold;">{{'question-management.detail.questionText' | translate }}:</span>
                        <span display-i18n-string="ctrl.question.questionText"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="ctrl.question.introduction">
                        <span style="font-weight: bold;">{{'question-management.detail.introduction' | translate }}:</span>
                        <span display-i18n-string="ctrl.question.introduction"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="ctrl.question.instruction">
                        <span style="font-weight: bold;">{{'question-management.detail.instruction' | translate }}:</span>
                        <span display-i18n-string="ctrl.question.instruction"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="ctrl.question.type">
                        <span style="font-weight: bold;">{{'question-management.detail.type' | translate }}:</span>
                        <span display-i18n-string="ctrl.question.type"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="ctrl.question.topic">
                        <span style="font-weight: bold;">{{'question-management.detail.topic' | translate }}:</span>
                        <span display-i18n-string="ctrl.question.topic"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="ctrl.question.annotations">
                        <span style="font-weight: bold;">{{'question-management.detail.annotations' | translate }}:</span>
                        <span display-i18n-string="ctrl.question.annotations"></span>
                    </div>
                </md-card-content>
            </md-card>
        </div>
        <div flex-gt-sm="50" layout="column">
            <md-card flex="auto" ng-class="{'fdz-reset-left-margin': $mdMedia('gt-sm'), 'fdz-reset-top-margin': $mdMedia('sm') || $mdMedia('xs')}">
                <md-card-header>
                    <md-card-header-text>
                        <h2 class="md-title">{{'global.cards.related-objects' | translate }}</h2>
                    </md-card-header-text>
                </md-card-header>
                <md-divider></md-divider>
                <md-card-content layout="column" layout-align="center start">
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="!ctrl.study" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/study.svg"></md-icon>
                            {{'study-management.detail.study' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="ctrl.study" class="fdz-truncate-string" flex>
                            <a ui-sref="studyDetail({id: ctrl.study.id})">
                                <md-icon md-svg-src="/assets/images/icons/study.svg"></md-icon>
                                {{'study-management.detail.study' | translate }}: <span display-i18n-string="ctrl.study.title"></span></a>
                            <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                {{'question-management.detail.tooltips.studies.one' | translate}}
                            </md-tooltip>
                        </div>
                    </div>
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="ctrl.counts.surveysCount == 0" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                            {{'survey-management.detail.surveys' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="ctrl.counts.surveysCount == 1 && ctrl.survey" class="fdz-truncate-string" flex>
                            <a ui-sref="surveyDetail({'id': ctrl.survey.id})">
                                <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                                {{'survey-management.detail.survey' | translate }}:
                                <span display-i18n-string="ctrl.survey.title"></span>
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                    {{'study-management.detail.tooltips.surveys.one' | translate}}
                                </md-tooltip>
                              </a>
                        </div>
                        <div ng-if="ctrl.counts.surveysCount > 1" class="fdz-truncate-string" flex>
                            <a ui-sref="search({'type': 'surveys', 'question': ctrl.question.id, 'study': ctrl.question.studyId, 'instrument': ctrl.question.instrumentId, 'sort-by': 'number'})">
                                <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                                {{'survey-management.detail.surveys' | translate }}: ({{ctrl.counts.surveysCount}})
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                    {{'study-management.detail.tooltips.surveys.many' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="!ctrl.instrument" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/instrument.svg"></md-icon>
                            {{'instrument-management.detail.instrument' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="ctrl.instrument" class="fdz-truncate-string" flex>
                            <a ui-sref="instrumentDetail({'id': ctrl.instrument.id})">
                                <md-icon md-svg-src="/assets/images/icons/instrument.svg"></md-icon>
                                {{'instrument-management.detail.instrument' | translate }}: <span display-i18n-string="ctrl.instrument.description"></span>
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                    {{'question-management.detail.tooltips.instruments.one' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="ctrl.counts.variablesCount == 0" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/variable.svg"></md-icon>
                            {{'variable-management.detail.variables' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="ctrl.counts.variablesCount == 1 && ctrl.variable" class="fdz-truncate-string" flex>
                            <a ui-sref="variableDetail({'id': ctrl.variable.id})">
                                <md-icon md-svg-src="/assets/images/icons/variable.svg"></md-icon>
                                {{'variable-management.detail.variable' | translate }}: <span display-i18n-string="ctrl.variable.label"></span>
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                    {{'question-management.detail.tooltips.variables.one' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                        <div ng-if="ctrl.counts.variablesCount > 1" class="fdz-truncate-string" flex>
                            <a ui-sref="search({'type': 'variables', 'question': ctrl.question.id, 'study': ctrl.question.studyId, 'instrument': ctrl.question.instrumentId, 'sort-by': 'dataSetNumber,indexInDataSet'})">
                                <md-icon md-svg-src="/assets/images/icons/variable.svg"></md-icon>
                                {{'variable-management.detail.variables' | translate }}: ({{ctrl.counts.variablesCount}})
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                    {{'question-management.detail.tooltips.variables.many' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="ctrl.counts.publicationsCount == 0" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                            {{'related-publication-management.detail.publications' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="ctrl.counts.publicationsCount == 1" class="fdz-truncate-string" flex>
                            <a ui-sref="relatedPublicationDetail({'id': ctrl.relatedPublication.id})">
                                <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                                {{'related-publication-management.detail.publication' | translate }}: {{ctrl.relatedPublication.title}}
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                    {{'question-management.detail.tooltips.publications.one' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                        <div ng-if="ctrl.counts.publicationsCount > 1" class="fdz-truncate-string" flex>
                            <a ui-sref="search({'type': 'related_publications', 'question':ctrl.question.id, 'study': ctrl.question.studyId, 'instrument': ctrl.question.instrumentId})">
                                <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                                {{'related-publication-management.detail.publications' | translate }}: ({{ctrl.counts.publicationsCount}})
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                    {{'question-management.detail.tooltips.publications.many' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                </md-card-content>
            </md-card>
        </div>
    </div>
    <div layout="column" layout-gt-sm="row">
        <div flex-gt-sm="50" layout="column">
            <md-card flex="auto" class="fdz-reset-top-margin">
                <div class="fdz-overlay-outer-box">
                    <div style="max-height:211px; overflow-y:hidden;">
                        <img display-i18n-string="ctrl.question.questionText" alt="" style="width: 100%; height: auto" ng-src="public/files/questions/{{ctrl.question.id}}" />
                    </div>
                    <div class="fdz-overlay-inner-box-bottom">
                        <md-button class="md-fab md-mini md-primary" ng-href="/public/files/questions/{{ctrl.question.id}}" target="_blank">
                            <md-icon md-svg-src="/assets/images/icons/arrow-expand.svg"></md-icon>
                            <md-tooltip md-direction="left" md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                {{'global.tooltips.images' | translate}}
                            </md-tooltip>
                        </md-button>
                    </div>
                </div>
            </md-card>
        </div>
        <div flex-gt-sm="50">
            <div hide-xs hide-sm class="fdz-fake-empty-card fdz-reset-top-margin" ng-class="{'fdz-reset-left-margin': $mdMedia('gt-sm')}"></div>
        </div>
    </div>
    <div layout="column" layout-gt-sm="row">
        <div flex-gt-sm="50" layout="column">
            <md-card flex="auto" class="fdz-reset-top-margin">
                <md-card-header>
                    <md-card-header-text>
                        <h2 class="md-title">{{'question-management.detail.predecessors' | translate }}</h2>
                    </md-card-header-text>
                </md-card-header>
                <md-divider></md-divider>
                <md-content style="background-color:white;">
                    <div style="width: 100%;" ng-repeat="predecessor in ctrl.predecessors">
                        <question-search-result search-result="predecessor._source" current-language="currentLanguage" bowser="bowser"></question-search-result>
                    </div>
                    <div layout="row" layout-align="center center" ng-if="ctrl.predecessors.length == 0" layout-padding>
                        {{'question-management.detail.no-predecessors' | translate}}
                    </div>
                </md-content>
            </md-card>
        </div>
        <div flex-gt-sm="50" layout="column">
            <md-card flex="auto" class="fdz-reset-top-margin" ng-class="{'fdz-reset-left-margin': $mdMedia('gt-sm')}">
                <md-card-header>
                    <md-card-header-text>
                        <h2 class="md-title">{{'question-management.detail.successors' | translate }}</h2>
                    </md-card-header-text>
                </md-card-header>
                <md-divider></md-divider>
                <md-content style="background-color:white;">
                    <div style="width: 100%;" ng-repeat="successor in ctrl.successors">
                        <question-search-result ng search-result="successor._source" current-language="currentLanguage" bowser="bowser"></question-search-result>
                    </div>
                    <div layout="row" layout-align="center center" ng-if="ctrl.successors.length == 0" layout-padding>
                        {{'question-management.detail.no-successors' | translate }}
                    </div>
                </md-content>
            </md-card>
        </div>
    </div>
    <div ng-if="ctrl.question.technicalRepresentation" layout="row">
        <md-card flex class="fdz-reset-top-margin">
            <md-card-header layout-align="center center">
                <md-card-header-text>
                    <h2 class="md-title">{{'question-management.detail.technical-representation' | translate }}
                        ({{ctrl.question.technicalRepresentation.type}})</h2>
                </md-card-header-text>
            </md-card-header>
            <md-divider></md-divider>
            <md-card-content>
                <div class="fdz-overlay-outer-box">
                    <div hljs hljs-language="{{ctrl.question.technicalRepresentation.language}}" hljs-source="ctrl.technicalRepresentationBeauty" style="margin-top: 0.5em;" class="fdz-code-container" ng-class="{'fdz-hidden-code': ctrl.representationCodeToggleFlag}"></div>
                    <div class="fdz-overlay-inner-box-top">
                        <md-button ng-click="ctrl.openSuccessCopyToClipboardToast('question-management.log-messages.question.technical-representation-success-copy-to-clipboard')" class="md-icon-button md-primary" ngclipboard data-clipboard-text="{{ctrl.technicalRepresentationBeauty}}">
                            <md-icon md-font-library="material-icons">content_copy</md-icon>
                            <md-tooltip md-direction="top" md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                {{'question-management.detail.copy-technical-representation-to-clipboard-tooltip' | translate}}
                            </md-tooltip>
                        </md-button>
                        <md-button class="md-icon-button md-primary" ng-click="ctrl.toggleRepresentationCode()">
                            <md-icon ng-if="ctrl.representationCodeToggleFlag" md-svg-src="/assets/images/icons/arrow-expand.svg"></md-icon>
                            <md-icon ng-if="!ctrl.representationCodeToggleFlag" md-svg-src="/assets/images/icons/arrow-compress.svg"></md-icon>
                            <md-tooltip md-direction="top" md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 100">
                                {{'question-management.detail.show-complete-technical-representation-tooltip.' + ctrl.representationCodeToggleFlag | translate }}
                            </md-tooltip>
                        </md-button>
                    </div>
                </div>
            </md-card-content>
        </md-card>
    </div>
</div>
